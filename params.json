{
  "name": "CHARIOT",
  "tagline": "A scalable processing architecture for Internet of Things",
  "body": "# CHARIOT [![Build Status](https://travis-ci.org/2020saurav/chariot-server.svg?branch=master)](https://travis-ci.org/2020saurav/chariot-server)\r\nCHARIOT is a framework to simplify request processing for Internet of Things. The idea is to do heavy computations on\r\nlegacy machines such as desktops or laptops rather than on IoT devices such as sensors or web cameras. This eliminates\r\nrequirement of powerful RAM or processors for any task on IoT devices and saves battery power of such devices. This\r\nidea is inspired from Pub-Sub pattern and RPC protocol.\r\n\r\nThis work was done as a course project in CS654A Software Architecture by Abhilash Kumar and Saurav Kumar at IIT Kanpur.\r\n\r\n## Nomenclature\r\nIn a chariot, the functionality (of movement) is provided by the wagon but the actual hard work is done by the horses.\r\nSymbolically, in this architecture the IoT devices become the wagon which has its own functionality but the processing\r\nshall be done by machines with high computational resources. Names of components:\r\n* Client Devices : Yaan (Sanskrit for wagon)\r\n* Processing Machines : Ashva (Sanskrit for horse)\r\n* Coordinating Machines : Prashti (Sanskrit for horse leader)\r\n* Zookeeper : Turagraksa (Sanskrit for patron of horse)\r\n\r\n## Architecture\r\n\r\n![logical](https://cloud.githubusercontent.com/assets/3881510/14587134/da32e114-04ca-11e6-88f4-0b8155ac2c6f.png)\r\n\r\n![physical](https://cloud.githubusercontent.com/assets/3881510/14587133/d005e376-04ca-11e6-8ede-991a7f1a843d.png)\r\n\r\n![process](https://cloud.githubusercontent.com/assets/3881510/14595178/c500796a-055a-11e6-9f19-1dfe509fc6a5.png)\r\n\r\n## Understanding the system\r\n\r\nTL; DR: Yaan (device) makes call to Prashti server and gets a response, which was processed at an Ashva inside the\r\ndocker image provided with the device.\r\n\r\nChariot Server: Chariot server consists of components such as Ashva, Prashti, Turagraksa and D2. The tasks of these\r\ncomponents are as follows:\r\n* Ashva: Execute the task assigned to it by a Prashti\r\n* Prashti: Receive requests from client and forward it to an Ashva, balancing the load.\r\n* Turagraksa: Zookeeper component to receive heartbeat from Ashva, ping other Zookeeper and ensure system recovery\r\n* D2: This component is separately deployed. It keeps the information of current Prashti servers.\r\n\r\nThe following image shows the work flow of server system.\r\n![workflow](https://cloud.githubusercontent.com/assets/3881510/14595445/dba55f94-055c-11e6-9243-6642b2b2b43f.png)\r\n\r\nChariot Client: Clients can be any device. To make request to the server, the device needs to form the request in a\r\nspecified format. Libraries are available (currently in Java and Python) to build requests and parse responses.\r\nExamples are present in usage section below.\r\n\r\n## Build and Deployment\r\nThis is a Gradle project which should be built using `gradle build`. The `build.gradle` file contains several tasks\r\nto deploy AshvaServer, PrashtiServer, ZookeeperServer, run different intergration tests and build complete jar.\r\nDeployment is faster without using Gradle.\r\n```bash\r\ngradle -q buildCompleteJar\r\njava -cp path/to/completejar in.cs654...Server\r\n```\r\nTo deploy servers, following are required:\r\n* RabbitMQ Server. Add `[{rabbit, [{loopback_users, []}]}].` in `/etc/rabbitmq/rabbitmq.config`\r\n* MongoDB\r\n* Docker\r\n* JDK 7\r\n\r\n## Usage: Building applications for CHARIOT framework\r\nWriting applications for CHARIOT framework is very simple and elegant. To build applications, developers need to create\r\na docker image which has the right functions in it. This docker image runs on the chariot-server. For simplification,\r\na base docker image `2020saurav/chariot:1.0` should be used (recommended). This image is built on Ubuntu 14.04 and has\r\nscripts to parse requests and responses into objects from bytes. One just needs to add the relevant functions for\r\nexecution of RPC functions.\r\n\r\n### Building your docker image\r\n```bash\r\ndocker pull 2020saurav/chariot:1.0\r\ndocker run -t -i 2020saurav/chariot:1.0 /bin/bash\r\ncd ~/chariot\r\nvi handler.py\r\n```\r\nThe `handler.py` looks like:\r\n```python\r\n#!/usr/bin/python3\r\n\r\ndef handle(request):\r\n  return globals()[request['function_name']]()\r\n\r\ndef testFunc():\r\n  return {'answer': '42'}\r\n```\r\n\r\nEdit `handler.py` to create any function, but remember to return a dictionary. The keys in the dictionary will be used\r\nto extract values from the response sent to the client. The RPC client can be in any language. At present, we are\r\nproviding support for python inside docker image. If you dig deeper, it is super simple to create interface in any\r\nlanguage. `/bin/chariot` in the docker image is the executable that is called by the Ashva processor. This executable\r\ntransfers the request to handler.py (by importing it).\r\n\r\nOnce `handler.py` is edited and ready to work, exit from the container\r\n```bash\r\nexit\r\ndocker commit -m \"Commit message\" -a \"Name of author\" <-container-id-> <-username/newImageName:version->\r\ndocker push <-username/newImageName:version-> # to push it to docker hub. requires to be logged in\r\n```\r\n\r\nOnce the docker image is ready, making calls to chariot server is even easier.\r\n\r\n### Java Application\r\n\r\n* Import chariot jar into your project (available under releases)\r\n* Make a request:\r\n```java\r\nPrashtiClient client = new PrashtiClient();\r\nBasicRequest request = BasicRequest.newBuilder()\r\n        .setRequestId(CommonUtils.randomString(32))\r\n        .setDeviceId(<deviceId>) // \"device42\"\r\n        .setFunctionName(<functionName>) // \"testFunc\"\r\n        .setArguments(new ArrayList<String>())\r\n        .setExtraData(new HashMap<String, String>())\r\n        .build();\r\nBasicResponse response = client.call(request);\r\n```\r\n\r\n### Python Application\r\n* Import chariot library (available [here](https://github.com/2020saurav/chariot-pyclient))\r\n* Make a request:\r\n```python\r\n#!/usr/bin/python3\r\nfrom chariot import *\r\nclient = PrashtiClient()\r\nrequest = {\r\n    'device_id' : <deviceId>, # 'device42'\r\n    'request_id' : randomReqId(),\r\n    'function_name' : <functionName>, # 'testFunc'\r\n    'arguments' : [],\r\n    'extra_data' : {}\r\n}\r\nresponse = client.call(request)\r\n```\r\n\r\n## Technologies Used\r\n* Java 7\r\n* Gradle build system\r\n* RabbitMQ RPC server\r\n* Apache Avro\r\n* Spark WebServer (for D2)\r\n* Docker\r\n* MongoDB\r\n* JUnit Test Framework\r\n\r\n## Future Works\r\n* Authentication\r\n* Encryption\r\n* IPv6 support (very minor changes required)\r\n",
  "note": "Don't delete this file! It's used internally to help with page regeneration."
}